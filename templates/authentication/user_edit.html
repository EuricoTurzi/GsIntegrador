{% extends 'base.html' %}

{% block title %}Editar {{ user_profile.username }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
  <!-- Header -->
  <div class="flex items-center space-x-4 mb-6">
    <a
      href="{% url 'authentication:user-detail' user_profile.id %}"
      class="text-gray-400 hover:text-gray-600 transition-colors"
    >
      <i class="fas fa-arrow-left text-xl"></i>
    </a>
    <h1 class="text-3xl font-bold text-gray-900">Editar Usuário</h1>
  </div>

  <!-- Formulário -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
    <form method="POST" class="space-y-6">
      {% csrf_token %}

      <!-- Informações do Perfil -->
      <div>
        <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
          <i class="fas fa-user mr-2 text-primary-600"></i>
          Informações do Perfil
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label
              for="username"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Username
            </label>
            <input
              type="text"
              id="username"
              value="{{ user_profile.username }}"
              disabled
              class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"
            />
            <p class="text-xs text-gray-500 mt-1">
              Username não pode ser alterado
            </p>
          </div>

          <div>
            <label
              for="email"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Email
            </label>
            <input
              type="email"
              id="email"
              name="email"
              value="{{ user_profile.email }}"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              required
            />
          </div>

          <div>
            <label
              for="first_name"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Primeiro Nome
            </label>
            <input
              type="text"
              id="first_name"
              name="first_name"
              value="{{ user_profile.first_name }}"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            />
          </div>

          <div>
            <label
              for="last_name"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Sobrenome
            </label>
            <input
              type="text"
              id="last_name"
              name="last_name"
              value="{{ user_profile.last_name }}"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            />
          </div>
        </div>
      </div>

      <!-- Informações da Empresa (apenas para Transportadora) -->
      {% if user_profile.user_type == 'TRANSPORTADORA' %}
      <div class="border-t border-gray-200 pt-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
          <i class="fas fa-building mr-2 text-primary-600"></i>
          Informações da Empresa
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label
              for="company_name"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Nome da Empresa
            </label>
            <input
              type="text"
              id="company_name"
              name="company_name"
              value="{{ user_profile.company_name }}"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
            />
          </div>

          <div>
            <label
              for="cnpj"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              CNPJ
            </label>
            <input
              type="text"
              id="cnpj"
              name="cnpj"
              value="{{ user_profile.cnpj }}"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              placeholder="00.000.000/0000-00"
            />
          </div>

          <div>
            <label
              for="phone"
              class="block text-sm font-medium text-gray-700 mb-1"
            >
              Telefone
            </label>
            <input
              type="tel"
              id="phone"
              name="phone"
              value="{{ user_profile.phone }}"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              placeholder="(00) 00000-0000"
            />
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Status e Permissões (apenas para Admin/GR) -->
      {% if user.is_superuser or user.user_type == 'GR' %}
      <div class="border-t border-gray-200 pt-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
          <i class="fas fa-shield-alt mr-2 text-primary-600"></i>
          Status e Permissões
        </h2>

        <div class="space-y-4">
          <div class="flex items-center">
            <input
              type="checkbox"
              id="is_active"
              name="is_active"
              {% if user_profile.is_active %}checked{% endif %}
              class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"
            />
            <label
              for="is_active"
              class="ml-2 text-sm font-medium text-gray-700"
            >
              Usuário Ativo
              <span class="text-xs text-gray-500 block"
                >Usuário pode acessar o sistema</span
              >
            </label>
          </div>

          <div class="flex items-center">
            <input
              type="checkbox"
              id="is_verified"
              name="is_verified"
              {% if user_profile.is_verified %}checked{% endif %}
              class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"
            />
            <label
              for="is_verified"
              class="ml-2 text-sm font-medium text-gray-700"
            >
              Conta Verificada
              <span class="text-xs text-gray-500 block"
                >Conta foi verificada pelo administrador</span
              >
            </label>
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Botões de Ação -->
      <div
        class="border-t border-gray-200 pt-6 flex items-center justify-between"
      >
        <a
          href="{% url 'authentication:user-detail' user_profile.id %}"
          class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium"
        >
          Cancelar
        </a>

        <button
          type="submit"
          class="px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium flex items-center"
        >
          <i class="fas fa-save mr-2"></i>
          Salvar Alterações
        </button>
      </div>
    </form>
  </div>

  <!-- Card de Informações -->
  <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
    <div class="flex items-start">
      <i class="fas fa-info-circle text-blue-600 mt-1 mr-3"></i>
      <div class="text-sm text-blue-800">
        <p class="font-medium mb-1">Informações Importantes:</p>
        <ul class="list-disc list-inside space-y-1">
          <li>O username não pode ser alterado após a criação da conta</li>
          <li>Alterações no email podem afetar o login do usuário</li>
          {% if user.is_superuser or user.user_type == 'GR' %}
          <li>Desativar um usuário impede o acesso ao sistema</li>
          {% endif %}
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}
